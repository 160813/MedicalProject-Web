轨迹预测是一个涉及多门学科的复杂的交叉研究课题，具有极高的科学价值和应用价值[1]。从时序数据的角度上看，轨迹预测问题可以被视为传统的序列生成问题，即根据移动对象过去的一系列轨迹点生成移动对象未来的一组可能轨迹点。本文主要研究的是二维平面上的船舶轨迹预测，依据历史轨迹信息的使用，可分为基于数据驱动的轨迹预测方法和基于物体行为的轨迹预测方法。如图1-1所示。

图1-1 轨迹预测模型分类图
1. 基于数据驱动的轨迹预测模型
数据驱动的轨迹预测模型是指通过对已有数据进行分析建模来实现轨迹预测任务。这类方法通常采用机器学习、深度神经网络等技术手段构建预测模型，并利用训练好的模型对新的轨迹数据进行预测。根据从历史轨迹数据提取隐藏特征的方式，该模型可分为三类：
（1）基于统计方法的轨迹预测
基于统计方法的轨迹预测是指利用统计学习理论中的相关算法，挖掘移动对象历史轨迹数据中所蕴含的规律性信息，例如周期性变化、随机游走等。早期的轨迹预测研究大多依赖于统计学的方法，这种方法能够在一定程度上解释轨迹数据所呈现出的模式化趋势。以下介绍几种主流的基于统计学的轨迹预测方法：
卡尔曼滤波器（Kalman Filter，KF）算法是一种常用的线性状态估计算法，它能够通过对系统的动态方程进行建模，实现对目标状态的最优估算。基于KF，乔少杰等人[2]使用系统的状态空间模型和观测模型，以最小均方差估计动态系统的状态，进而实现对未来轨迹点的连续预测。Lin等人[3]针对行人轨迹预测问题，提出了一种基于双峰扩展卡尔曼滤波器的方法。该方法采用了双峰模型，能够更好地捕捉行人行为的多样性，并且可以更好地拟合行人在移动时可能会发生转弯、加速或减速等行为变化。
隐马尔可夫模型（Hidden Markov Model，HMM）的基本思想是通过对观察到的输入输出信号进行转换处理，建立出隐含层节点之间的映射关系，最终得到概率分布函数。Narayanan等人[4]提出了一种基于HMM的多变量状态预测方法用于实时轨迹预测。该方法利用传感器数据和历史轨迹信息，结合HMM的状态转移概率和观测概率，预测未来的轨迹。该方法还引入了一种基于历史轨迹分段的方法，用于解决轨迹非线性的问题。针对室内轨迹预测问题，Wang等人[5]提出了一种基于HMM的混合方法，该方法首先根据Wi-Fi接入点的相似性对其进行聚类，然后，研究了一种基于频繁子轨迹的HMM，用以捕捉行人的移动模式。
高斯混合模型（Gaussian Mixed Model，GMM）是一种广泛应用于时间序列数据分析和预测的机器学习模型，可用于计算移动对象轨迹的联合分布概率，从而更好地描述移动对象的运动规律，这为轨迹预测提供了一种有效的解决方案。Ma等人[6]提出了一种基于GMM的轨迹预测方法，建立了一个基于贝叶斯框架的轨迹预测模型，并通过滑动窗口对轨迹进行采样，最后利用GMM对轨迹的概率密度函数进行求解。Xing等人[7]提出了一种基于联合时间序列建模和GMM的个性化轨迹预测方法。该方法能够通过车辆间的通信和信息共享来实现对每个车辆的个性化轨迹预测，同时利用GMM对轨迹数据进行聚类分析，提高预测准确性。
高斯过程回归模型是一种基于核密度估计的无参数机器学习方法，适用于处理高维稀疏数据。适用于处理高维稀疏数据，广泛应用于时间序列预测、图像识别等领域。Yoon等人[8]提出了一种利用车辆之间相互作用信息的概率预测方法。首先，通过高斯过程回归模型得到表征变道运动特征的行为参数的概率分布。随后，利用路径跟踪模型对变道车辆的未来状态进行概率估计，该模型引入了基于行为参数信息的虚拟测量，能更好地预测多车场景下的车辆变道轨迹。
（2）基于池化层机制的轨迹预测
基于先前社会力模型[9]的研究，长短期记忆网络（Long Short-Term Memory，LSTM）具有有效学习和再现长序列的能力，Alahi等人[10]提出了Social LSTM（Social Long Short-Term Memory），用于密集场景下行人轨迹的预测。每条轨迹被建模为一个LSTM单元，并通过社会池化层完成行人间的信息交互，从而生成符合社会规范的轨迹。
Xue等人[11]提出了社交场景长短期记忆网络模型，采用三层LSTM分别捕捉行人、社会互动和静态语义信息。Xue用圆形领域范围取代了以往的矩形领域范围，圆形领域范围这一设定更符合行人与邻居之间的社会互动取决于二者之间的距离这一传统认知。Lisotto等人[12]对于场景中的静态信息采用了独热编码的形式，仅对场景中的草、建筑、汽车、道路等信息进行编码，邻域范围仍采用矩形区域的形式，每个区域的静态语义信息为该区域所有的独热编码加权平均求得。Pfeiffer等人[13]提出了基于极坐标的一维网格编码周围邻居的隐藏层信息。与二维网格相比，基于极坐标的一维网格可以连续地捕获径向距离变化，且在每个角度范围内，只考虑最近的行人，这与现实场景更为贴合。
现实场景中人们(朋友、夫妇、家庭成员等)往往表现出连贯的运动模式。基于这一现象，Bisagno N等人[14]提出了Group LSTM。首先，通过利用相干滤波方法[15]，检测出人群中具有一致运动趋势的人。模型只考虑群体外的互动而不考虑群体内的互动。Group LSTM有效地改善了Social LSTM把属于同一群体行人的轨迹预测后过于行人轨迹分散开来这一现象。Zhou L等人[16]进一步细化了Group LSTM的观点，将群体中的互动分为分为群体内互动、群体外互动和群体间互动。基于此，他们提出了一种群体约束层次图注意网络（Group Constrained Hierarchical Graph Attention networks，GCHGAT），用于捕获群体间的交互。
虽然基于LSTM的神经网络模型在轨迹预测方面取得了显著的进展，但这些模型的预测结果往往与数据集高度拟合，是模型平均状态下预测出的单一轨迹，与行人在现实场景下所表现出的高机动性的行为不符。为了使模型趋向于生成多样性的轨迹，Gupta等人[17]提出了Social GAN（Social Generative Adversarial Network）模型，通过使用最大特征池对行人之间的交互进行全局分析，并引入噪声z、改进多样性损失函数。
（3）基于注意力机制的轨迹预测
池化层在进行池化操作时往往会丢失一部分信息[18]，而基于注意力机制的方法可以在不丢失信息的情况下进行特征提取和降维。注意力机制可以根据输入的特征自适应地调整每个特征的重要性，以便更准确地捕获输入中的关键信息。基于注意力机制的方法已经在许多自然语言处理和计算机视觉任务中都取得了良好的效果。基于此，Sadeghian等人[19][Sadeghian, 2019 #5001][Sadeghian, 2019 #5001]提出的Sophie使用物理注意力和社交注意力来表示场景对行人以及行人相互之间的交互。Li等人[20]提出了一种基于循环注意力和交互模型的行人轨迹预测方法。该方法从历史轨迹中学习行人的运动模式，并在预测过程中通过多次注意力机制来自适应地选择轨迹的关键部分，并结合行人之间的交互信息，预测行人的未来的轨迹。
Xu等人[21]借鉴了残差学习的思路，模型预测的是当前时刻相对于上一个时刻的位移偏移量，通过计算行人与邻居的隐藏层特征之间的内积，作为两个行人之间空间亲和力的度量。Zhang[22]等人提出了State-Refinement LSTM (SR-LSTM)，舍弃了以往直接采用当前时刻隐藏层状态用以计算社会互动的方法，而是在此之前添加了一个状态细化模块，用于捕捉周围邻居的行为意图，并延续了Xu等人的做法，根据行为意图，采用加权机制来衡量每个人对其他人的贡献。
近年来，一些学者也尝试将注意力机制与图神经网络相结合，基于图神经网络的方法通过将移动对象建模为图中节点，将移动对象之间的空间交互以及自身的时间交互建模为图中的边，边的权重大小表示的是该邻居对研究对象的重要程度。Huang等人[23]提出了一个STGAT（Spatial-Temporal Graph Attention Network）模型用于建模人类的时空交互关系。该方法主要基于图卷积神经网络和注意力机制，用于自适应地学习行人之间的时空交互。在该方法中，首先将行人轨迹表示为一个有向图的形式，然后通过图卷积神经网络来提取每个行人的空间特征和时间特征。接着，利用注意力机制来自适应地调整不同行人之间的交互权重，以更好地捕捉他们之间的时空交互信息。最后，通过一个多头自注意力机制，将不同行人的特征进行整合，从而得到整个场景的轨迹预测结果。Xu Y等人[24]针对乡村车辆轨迹数据不足的情况，将图神经网络与迁移学习结合，将车辆作为图中的节点，并将车辆之间的关系表示为边，通过学习源域（城市）中的数据来提升目标域（乡村）中的预测精度。
2. 基于移动物体行为的轨迹预测
移动物体轨迹预测模型是一种基于对象行为模式的模型，旨在通过推断对象在下一时刻的可能行动或位置来预测其轨迹。为了预测移动物体的轨迹，需要先了解其行为模式，包括其在一段时间内采取的运动方式、方向和速度等。根据获取行为模式的不同方法，该模型可分为两类：
（1）基于移动物体动力学的轨迹预测
动力学模型可以较好地刻画移动对象的运动规律，因此基于动力学模型的轨迹预测方法也被广泛关注。以行人为例，在对其进行动力学建模时，需要考虑诸如步频、步幅、加速度等因素。Rudenko等人[25]提出了一种新的基于规划的算法来预测人类的运动。在社会环境中导航，他们通过将行人的运动进行横向和纵向两个方向进行分解，并利用群体社会力量来模拟人们的局部避免冲突行为。采用加权随机游走过程对个体全局运动策略进行联合抽样，在此过程中，每个人都受到来自附近其他行人和群体成员的社会力量的影响。Tseng等人[26]通过安装在十字路口的雷达来收集车辆动态。对采集到的数据进行处理，计算出车辆与道路对应的偏转角度，利用集成方法构建模型，预测未来车辆与道路相对应的偏转角度。
（2）基于意图识别的轨迹预测
基于意图识别的轨迹预测属于行为预测范畴。此类方法关注的是移动对象的主观意识，例如驾驶员是否想要超速或变道等。此类方法通常依赖于传感器获取的实时交通信息，然后利用深度学习技术对这些信息进行处理，从中挖掘出行驶者的潜在意图。比如，Feng等人[27]提出了一种基于意图的条件变分自编码器（IVAE）来预测车辆轨迹的方法。该方法考虑车辆行驶时的意图，如车辆是否要转弯或变道等，以提高轨迹预测的准确性。Li等人[28]提出了一个结合图神经网络的条件深度生成模型，该模型分别对智能体间的社会关系和智能体内的行为意图建模为图，使用生成模型预测未来轨迹。相比于传统方法，该模型考虑了多智能体之间的交互作用和不确定性，能够更准确地预测未来轨迹。
1.2.2 船舶轨迹预测
船舶航行轨迹预测是利用历史数据建立模型，以预测未来船舶的位置、速度等状态变化。在航运领域中，这项技术对于船舶调度、航线规划和海上交通管理非常重要。与通用轨迹预测不同，船舶的运动规律更为复杂，因为受到船舶类型、操作系统和尺寸等因素的影响，通常需要大量的历史轨迹数据才能学习得到。船舶轨迹预测可以采用基于数据驱动和基于船舶行为的两种方法：
1.基于数据驱动的轨迹预测模型
根据上述分析，船舶轨迹预测需要考虑多种因素，如船舶运动模式、与环境之间的交互等。基于数据驱动的轨迹预测模型可以通过统计学、注意力机制以及混合模型等多种方式来实现，它们可以有效地帮助我们更好地预测轨迹变化趋势，具体描述如下：
（1）基于统计方法的轨迹预测
Luo等人[29]将扩展卡尔曼滤波（Extended Kalman Filter，EKF）与最小二乘支持向量回归（Least Squares Support Vector Regression，LSSVR）两种算法相结合来对船舶轨迹进行预测。首先通过EKF用于对轨迹进行滤波和预测，然后再使用LSSVR则用于对预测结果进行修正和优化。Dalsnes等人[30]提出了一种基于自动识别系统（AIS）的船舶轨迹预测方法，称为邻居航线分布方法。该方法使用GMM来建模船舶的运动特征，并利用历史船舶数据来学习模型参数，从而对未来航线进行预测。与传统的预测方法相比，该方法考虑到了邻近船舶的运动状态，从而提高了预测的准确性和稳定性。针对大型船舶的轨迹预测问题，Zhang等人[31]提出了一种基于小波分析的HMM，通过使用小波分析方法对原始轨迹数据进行了特征提取，得到了船舶轨迹的速度、加速度等关键特征，使得模型更能准确地捕捉轨迹的动态特征。
（2）基于注意力机制的轨迹预测
Wang等人[32]提出了一种基于注意的双向LSTM来用于预测船舶轨迹。与单向LSTM相比，双向结构有助于提高精度，因为它可以增强历史和未来时间序列数据之间的相关性。引入注意机制，允许对双向LSTM网络中不同隐藏信息部分，分配相对应的计算权重。Liu等人[33]将卷积转换与基于注意力的双向LSTM相结合，用于长期轨迹预测。1维卷积层被放在整个网络的开头，用于从网格结构数据中提取潜在特征。Sekhon[34]利用一种基于注意的LSTM编码器-解码器架构的新型深度学习模型进行船舶轨迹预测。该模型结合了空间和时间的注意力机制，以及空间和时间的权重，以允许关注不同的信息区域。除了上述的双向结构和注意力机制外，Ding等人[35]首次提出了一种变分LSTM模型用于海上船舶轨迹预测。实验结果表明，变分LSTM方法可以学习比基本LSTM网络更多的高度结构化序列数据的潜在特征。
（3）混合模型的轨迹预测
混合模型轨迹预测方法的本质在于通过将多种技术结合使用，以期充分利用各种技术的优势，实现更加准确的预测结果。Murray等人[36]提出了一种混合框架来预测船舶的未来轨迹。该框架包含轨迹聚类、轨迹分类和轨迹预测3个模块。在第一个模块中，引入GMM聚类算法对相似历史轨迹进行分组。然后，对于轨迹分类模块，使用K近邻算法将选定的轨迹分类到特定的聚类中。在最后一个模块中，对所选的聚类轨迹进行了双线性自编码器。Gao等人[37]设计了一种多步预测模型，它是一种混合了模拟、统计和深度学习的方法。该模型包括3个步骤:支撑点预测、目的地预测和轨迹插值。支撑点是通过训练一个LSTM网络预测的，而目的地预测是基于两个轨迹满足几个预定义条件的假设下的历史数据过滤。根据得到的支撑点和目标位置信息，采用三次样条插值技术对轨迹进行仿真。Li等人[38]阐述了一种基于聚类和深度学习的混合模型用于长期船舶轨迹预测，首先使用动态时间规整算法将船舶轨迹进行对齐和规范化，然后使用聚类分析来识别轨迹中的常见模式，并将这些模式用于建立基于机器学习的预测模型，从而避免了对复杂的物理模型的依赖。这种基于模式的建模方法具有更好的可解释性和可泛化性。
2.基于船舶行为的轨迹预测
基于船舶行为的轨迹预测模型是通过分析船舶自身特性或其他船舶行为规律来预测船舶的轨迹变化。这类模型一般包括动力学模型、控制模型和环境影响模型等，其中动力学模型是预测船舶轨迹的基础理论，可以描述船舶的运动状态和随时间的变化规律。张阳等人[39]针对内河水域中的船舶轨迹预测问题，使用了基于二阶运动学方程的动力学模型来描述船舶的运动状态，综合考虑船舶航行过程中受到的各种环境因素以及船舶本身的特性，并通过对动力学模型的评估来验证轨迹预测的准确性和可靠性。
